image: Visual Studio 2019

environment:
  PYTHON_VERSION: "2.6.6"
    
platform:
  - x64

cache:
  - node_modules
  - '%APPDATA%\npm-cache'
  - '%USERPROFILE%\.electron'
  - '%USERPROFILE%\AppData\Local\Yarn\cache'

init:
  - git config --global core.autocrlf input

install:
  - ps: Install-Product node 21 x64
  - ps: |
      $url = "https://www.python.org/ftp/python/$env:PYTHON_VERSION/python-$env:PYTHON_VERSION-amd64.exe"
      $pythonInstaller = "$env:TEMP\python-installer.exe"
      Invoke-WebRequest -Uri $url -OutFile $pythonInstaller
      Start-Process -Wait -FilePath $pythonInstaller -ArgumentList "/quiet", "InstallAllUsers=1", "PrependPath=1"
  # Redémarrer la session PowerShell pour que les modifications de l'environnement soient prises en compte
  - ps: Start-Process -FilePath powershell -ArgumentList '-NoProfile', '-Command', '& { Restart-Computer -Force }' -Verb RunAs
  # Vérifier l'installation de Python
  - python --version
  - yarn

build_script:
  - python --version
  - yarn run realese

artifacts:
  - path: dist
    name: MyApp

test: false
